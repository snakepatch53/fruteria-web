import{r as i,C as N,j as e,k as _,L as $,F as g,m as F,a as I,c as U,v as A}from"./index-06cXOb2S.js";import{g as L,s as P,u as D}from"./customers-o088eSFV.js";import{i as E}from"./validations-BBJ6c9mv.js";function H(){const{products:t,combos:s,updateProductQuantity:l,updateComboQuantity:r}=i.useContext(N);if(t===null||s===null)return null;const a=t.reduce((c,x)=>c+x.price*x.quantity,0)+s.reduce((c,x)=>c+x.price*x.quantity,0),o=a*"0.15",h=a+o;return e.jsxs(_,{className:" flex flex-col ",children:[e.jsx("div",{className:" sticky top-0 z-10 flex items-center px-[--p] h-20 bg-[--c1] text-[--c1-txt] ",children:e.jsxs("div",{className:" container justify-between items-center ",children:[e.jsxs($,{to:"/",className:" flex items-center gap-2 p-4  rounded-full transition duration-300 ease-in-out transform hover:scale-105  hover:bg-black/10 ",children:[e.jsx(g,{icon:F}),e.jsx("span",{children:"Volver a la Tienda"})]}),e.jsx("div",{className:" flex p-4 bg-[--c2] rounded-full text-[--c2-txt2] opacity-80 ",children:e.jsx(g,{icon:I})})]})}),e.jsx("div",{className:" p-5 md:p-10 min-h-[100dvh] ",children:e.jsxs("div",{className:" container flex flex-col gap-5 ",children:[t==null?void 0:t.map(c=>e.jsx(Q,{product:c,updateQuantity:l},c.id)),s==null?void 0:s.map(c=>e.jsx(R,{combo:c,updateQuantity:r},c.id))]})}),e.jsxs("div",{className:" sticky bottom-0 flex flex-col items-center gap-2 px-[--p] py-4 bg-[--c3] text-[--c3-txt] backdrop-blur-md ",style:{boxShadow:"0px -2px 10px 0px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{className:" flex justify-center gap-2  ",children:[e.jsx("span",{className:" font-bold ",children:"Subtotal: "}),e.jsxs("span",{children:["$",a.toFixed(2)]})]}),e.jsxs("div",{className:" flex justify-center gap-2  ",children:[e.jsx("span",{className:" font-bold ",children:"IVA: "}),e.jsxs("span",{children:["$",o.toFixed(2)]})]}),e.jsxs("div",{className:" flex justify-center gap-2  ",children:[e.jsx("span",{className:" font-bold ",children:"Total: "}),e.jsxs("span",{children:["$",h.toFixed(2)]})]}),e.jsx(T,{})]})]})}function Q({product:t,updateQuantity:s}){const l=t.price*t.quantity;return e.jsxs("div",{className:"flex flex-col xs:flex-row items-center justify-between px-3 py-3 md:px-8 border rounded-lg ",children:[e.jsx("div",{className:" p-2 w-24 md:w-32 aspect-square ",children:e.jsx("img",{className:" w-full h-full object-contain  rounded-md ",src:t.image_url,alt:t.name})}),e.jsxs("div",{className:" flex-1 flex flex-col gap-1",children:[e.jsx("h3",{className:" text-sm md:text-base uppercase font-bold leading-[15px] text-center xs:text-left md:text-center ",children:t.name}),e.jsxs("div",{className:" flex flex-col-reverse xs:flex-row ",children:[e.jsxs("div",{className:" flex-1 flex flex-col ",children:[e.jsxs("span",{className:"opacity-70 text-xs md:text-base text-center xs:text-left md:text-center ",children:["$",t.price," / ",t.sale_type]}),e.jsxs("div",{className:"flex gap-3 items-center mt-2 mx-auto xs:mx-0 md:mx-auto ",children:[e.jsx(p,{text:"-",onClick:()=>s(t,!1)}),e.jsx("span",{children:t.quantity}),e.jsx(p,{text:"+",onClick:()=>s(t)})]})]}),e.jsxs("span",{className:" flex items-center text-base md:text-lg text-[--c2-txt2] text-center xs:text-left ",children:["$",l.toFixed(2)]})]})]})]})}function R({combo:t,updateQuantity:s}){let l=t.combo_products.map(a=>a.product);const r=t.price*t.quantity;return e.jsxs("div",{className:"flex flex-col xs:flex-row items-center justify-between px-3 py-3 md:px-8 border rounded-lg ",children:[e.jsx("div",{className:" p-2 grid grid-cols-[repeat(auto-fit,minmax(30px,1fr))] w-full xs:w-24 md:w-32 ",children:l.map(a=>e.jsx("img",{className:" w-full object-contain  rounded-md ",src:a.image_url,alt:a.name},a.id))}),e.jsxs("div",{className:" flex-1 flex flex-col gap-1",children:[e.jsx("h3",{className:" text-sm md:text-base uppercase font-bold leading-[15px] text-center xs:text-left md:text-center ",children:t.name}),e.jsxs("div",{className:" flex flex-col-reverse xs:flex-row ",children:[e.jsxs("div",{className:" flex-1 flex flex-col ",children:[e.jsxs("span",{className:"opacity-70 text-xs md:text-base text-center xs:text-left md:text-center ",children:["$",t.price," / Unidad"]}),e.jsxs("div",{className:"flex gap-3 items-center mt-2 mx-auto xs:mx-0 md:mx-auto ",children:[e.jsx(p,{text:"-",onClick:()=>s(t,!1)}),e.jsx("span",{children:t.quantity}),e.jsx(p,{text:"+",onClick:()=>s(t)})]})]}),e.jsxs("span",{className:" flex items-center text-base md:text-lg text-[--c2-txt2] text-center xs:text-left ",children:["$",r.toFixed(2)]})]})]})]})}function p({text:t,onClick:s}){return e.jsx("button",{onClick:s,className:"flex bg-[--c4] text-[--c4-txt] text-center rounded-md w-10 aspect-square  items-center justify-center",children:t})}function T(){const[t,s]=i.useState(null),[l,r]=i.useState(""),[a,o]=i.useState(""),[h,c]=i.useState(!0),[x,f]=i.useState(""),{combos:v,products:y,resetCart:w}=i.useContext(N),C=m=>{if(r(m),!E(m))return f("CÃ©dula invÃ¡lida");f(""),L().then(d=>{c(!1);const u=d.find(j=>j.cedula==m);u&&(o(u.name),s(u))})},S=async m=>{m.preventDefault();let d=null;if(t){const n=await D(t.id,{cedula:l,name:a});if(!n.success)return f(n.error);d=n.data}else{const n=await P({cedula:l,name:a});if(!n.success)return f(n.error);d=n.data}const u=await A({customer_id:d.id,product_sales:y.map(n=>({product_id:n.id,quantity:n.quantity,price:n.price})),combo_sales:v.map(n=>({combo_id:n.id,quantity:n.quantity,price:n.price}))});w();const j=window.location.origin+"/venta/"+u.data.id,k=`https://api.whatsapp.com/send?phone=+593 98 019 9938&text=${`Hola ðŸ‘‹, me contacto desde tu tienda de frutas web ðŸ’»: 

*Nombre:* ${d.name}
*Asunto:* Gestion de carrito de compras ðŸŽ‰
*Url:* ${j}`}`,q=encodeURI(k);window.open(q,"_blank")};return e.jsxs("form",{onSubmit:S,className:" flex flex-col gap-3 w-full max-w-64 text-center ",children:[e.jsx(b,{value:l,onChange:C,placeholder:"CÃ©dula"}),e.jsx(b,{value:a,onChange:o,placeholder:"Nombre",disabled:h}),e.jsx("span",{className:" flex justify-center items-center h-4 text-xs text-center text-red-600 ",children:x}),e.jsx("button",{type:"submit",className:" border bg-[--c1] text-[--c1-txt] flex justify-center items-center gap-2 w-full max-w-64 rounded-lg p-3 text-center opacity-90 transition hover:scale-110 hover:opacity-100 ",children:"Comprar"})]})}function b({value:t,onChange:s,placeholder:l,disabled:r}){return e.jsx("input",{value:t,onChange:a=>s(a.target.value),className:U(" border p-2 rounded w-full ",{" bg-black/10 ":r}),placeholder:l,disabled:r})}export{H as default};
